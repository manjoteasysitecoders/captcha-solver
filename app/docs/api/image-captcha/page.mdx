# Image CAPTCHA API
Extract readable text from an image-based CAPTCHA using our Vision-powered OCR pipeline.

**Endpoint:** `POST /api/public/imageCaptcha`


## Authentication

All requests must include a valid API key in the request headers:
```
"x-api-key": YOUR_API_KEY
```

Requests without an API key or with an invalid key will be rejected.


## Credits & Usage

- **Cost per request**: 10 credits

- Credits are deducted before processing the image.

- If the user has fewer than 10 credits, the request will fail.

- Each successful request increments the user's **totalRequests** count.

## Request options

**Option 1: Upload Image (multipart/form-data)**

**Content-type:**  ```multipart/form-data```

**Option 2: Image URL (application/json)**

**Content-type:**  ```application/json```

```json
{ "url": "https://example.com/captcha.png" }
```

**Successful Response (200):**

```json
{
"success": true,
"message": "Text extracted successfully.",
"text": "<extracted text>"
}
```

**Notes**

- Extracted text preserves original casing, spacing, and line breaks as closely as possible.

- The Vision model attempts to read all visible text, not only alphanumeric CAPTCHA characters.
                  
## Error Responses

**Missing Image Input (400)**
```
{
  "success": false,
  "error": "Provide either a 'file' or a 'url'."
}
```

**Missing API Key (401)** 
```
{
"error": "API key is required"
}
```

**Invalid API Key (401)**
```
{
"error": "Invalid or revoked API key"
}
```

**Insufficient Credits (403)**
```
{
"error": "Insufficient credits"
}
```

**Server Error (500)**
```
{
"success": false,
"error": "Internal server error"
}
```

**Example (curl):**

```bash
curl -X POST http://localhost:3000/api/public/imageCaptcha \
-H "Content-Type: application/json" \
-H "x-api-key: YOUR_API_KEY" \
-d '{"imageUrl":"https://example.com/captcha.png"}'
```

**Implementation Notes**

- Uses OpenAI Vision-style ```input_image``` flow via ```extractTextFromImage()```
- API key usage updates ```lastUsedAt```
- Credit deduction and request tracking are atomic per request

If you need **[Text CAPTCHA API](/docs/api/text-captcha)** or  **[Audio CAPTCHA API](/docs/api/voice-captcha)**, see the related API documentation sections.
